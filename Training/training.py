{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "2fd01b04",
   "metadata": {},
   "source": [
    "## Setting up the environment"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "65114fb8",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import glob\n",
    "import matplotlib.pyplot as plt\n",
    "import matplotlib.image as mpimg\n",
    "import os\n",
    "import seaborn as sns\n",
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "b9d122fd",
   "metadata": {},
   "outputs": [],
   "source": [
    "#!pip install psutil"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "2a9ca6fa",
   "metadata": {},
   "outputs": [],
   "source": [
    "# import psutil\n",
    "\n",
    "\n",
    "# memory_info = psutil.virtual_memory()\n",
    "\n",
    "# # Display memory details (Help from ChatGpt)\n",
    "# print(f\"Total Memory: {memory_info.total / (1024 ** 3):.2f} GB\")\n",
    "# print(f\"Available Memory: {memory_info.available / (1024 ** 3):.2f} GB\")\n",
    "# print(f\"Used Memory: {memory_info.used / (1024 ** 3):.2f} GB\")\n",
    "# print(f\"Memory Usage Percentage: {memory_info.percent}%\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "abadf283",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2024-09-14 22:25:48.621881: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\n",
      "To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n",
      "2024-09-14 22:25:49.127353: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\n"
     ]
    }
   ],
   "source": [
    "import tensorflow"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "203c04a6",
   "metadata": {},
   "outputs": [],
   "source": [
    "!git clone https://github.com/ultralytics/yolov5.git"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "a12e4051",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/home/abhinav/HackAthon/yolov5\n"
     ]
    }
   ],
   "source": [
    "cd /home/abhinav/HackAthon/yolov5/"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f20fcc39",
   "metadata": {},
   "source": [
    "## Training"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "8886edb6",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[34m\u001b[1mtrain: \u001b[0mweights=yolov5s.pt, cfg=, data=custom.yaml, hyp=data/hyps/hyp.scratch-low.yaml, epochs=200, batch_size=16, imgsz=640, rect=False, resume=False, nosave=False, noval=False, noautoanchor=False, noplots=False, evolve=None, bucket=, cache=ram, image_weights=False, device=, multi_scale=False, single_cls=False, optimizer=SGD, sync_bn=False, workers=8, project=runs/train, name=exp, exist_ok=False, quad=False, cos_lr=False, label_smoothing=0.0, patience=100, freeze=[0], save_period=-1, seed=0, local_rank=-1, entity=None, upload_dataset=False, bbox_interval=-1, artifact_alias=latest\n",
      "\u001b[34m\u001b[1mgithub: \u001b[0m‚ö†Ô∏è YOLOv5 is out of date by 186 commits. Use 'git pull' or 'git clone https://github.com/ultralytics/yolov5' to update.\n",
      "YOLOv5 üöÄ v7.0-180-g9bb50b4f Python-3.9.16 torch-2.0.1+cu117 CUDA:0 (NVIDIA GeForce GTX 1080 Ti, 11177MiB)\n",
      "\n",
      "\u001b[34m\u001b[1mhyperparameters: \u001b[0mlr0=0.01, lrf=0.01, momentum=0.937, weight_decay=0.0005, warmup_epochs=3.0, warmup_momentum=0.8, warmup_bias_lr=0.1, box=0.05, cls=0.5, cls_pw=1.0, obj=1.0, obj_pw=1.0, iou_t=0.2, anchor_t=4.0, fl_gamma=0.0, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, degrees=0.0, translate=0.1, scale=0.5, shear=0.0, perspective=0.0, flipud=0.0, fliplr=0.5, mosaic=1.0, mixup=0.0, copy_paste=0.0\n",
      "\u001b[34m\u001b[1mComet: \u001b[0mrun 'pip install comet_ml' to automatically track and visualize YOLOv5 üöÄ runs in Comet\n",
      "\u001b[34m\u001b[1mTensorBoard: \u001b[0mStart with 'tensorboard --logdir runs/train', view at http://localhost:6006/\n",
      "Overriding model.yaml nc=80 with nc=8\n",
      "\n",
      "                 from  n    params  module                                  arguments                     \n",
      "  0                -1  1      3520  models.common.Conv                      [3, 32, 6, 2, 2]              \n",
      "  1                -1  1     18560  models.common.Conv                      [32, 64, 3, 2]                \n",
      "  2                -1  1     18816  models.common.C3                        [64, 64, 1]                   \n",
      "  3                -1  1     73984  models.common.Conv                      [64, 128, 3, 2]               \n",
      "  4                -1  2    115712  models.common.C3                        [128, 128, 2]                 \n",
      "  5                -1  1    295424  models.common.Conv                      [128, 256, 3, 2]              \n",
      "  6                -1  3    625152  models.common.C3                        [256, 256, 3]                 \n",
      "  7                -1  1   1180672  models.common.Conv                      [256, 512, 3, 2]              \n",
      "  8                -1  1   1182720  models.common.C3                        [512, 512, 1]                 \n",
      "  9                -1  1    656896  models.common.SPPF                      [512, 512, 5]                 \n",
      " 10                -1  1    131584  models.common.Conv                      [512, 256, 1, 1]              \n",
      " 11                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']          \n",
      " 12           [-1, 6]  1         0  models.common.Concat                    [1]                           \n",
      " 13                -1  1    361984  models.common.C3                        [512, 256, 1, False]          \n",
      " 14                -1  1     33024  models.common.Conv                      [256, 128, 1, 1]              \n",
      " 15                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']          \n",
      " 16           [-1, 4]  1         0  models.common.Concat                    [1]                           \n",
      " 17                -1  1     90880  models.common.C3                        [256, 128, 1, False]          \n",
      " 18                -1  1    147712  models.common.Conv                      [128, 128, 3, 2]              \n",
      " 19          [-1, 14]  1         0  models.common.Concat                    [1]                           \n",
      " 20                -1  1    296448  models.common.C3                        [256, 256, 1, False]          \n",
      " 21                -1  1    590336  models.common.Conv                      [256, 256, 3, 2]              \n",
      " 22          [-1, 10]  1         0  models.common.Concat                    [1]                           \n",
      " 23                -1  1   1182720  models.common.C3                        [512, 512, 1, False]          \n",
      " 24      [17, 20, 23]  1     35061  models.yolo.Detect                      [8, [[10, 13, 16, 30, 33, 23], [30, 61, 62, 45, 59, 119], [116, 90, 156, 198, 373, 326]], [128, 256, 512]]\n",
      "Model summary: 214 layers, 7041205 parameters, 7041205 gradients, 16.0 GFLOPs\n",
      "\n",
      "Transferred 343/349 items from yolov5s.pt\n",
      "\u001b[34m\u001b[1mAMP: \u001b[0mchecks passed ‚úÖ\n",
      "\u001b[34m\u001b[1moptimizer:\u001b[0m SGD(lr=0.01) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias\n",
      "WARNING ‚ö†Ô∏è DP not recommended, use torch.distributed.run for best DDP Multi-GPU results.\n",
      "See Multi-GPU Tutorial at https://docs.ultralytics.com/yolov5/tutorials/multi_gpu_training to get started.\n",
      "\u001b[34m\u001b[1mtrain: \u001b[0mScanning /home/abhinav/HackAthon/yolov5/Dataset1/train/labels... 1312 ima\u001b[0m\n",
      "\u001b[34m\u001b[1mtrain: \u001b[0mNew cache created: /home/abhinav/HackAthon/yolov5/Dataset1/train/labels.cache\n",
      "\u001b[34m\u001b[1mtrain: \u001b[0mCaching images (1.2GB ram): 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1312/1312 [00:01<00:00, 1232\u001b[0m\n",
      "\u001b[34m\u001b[1mval: \u001b[0mScanning /home/abhinav/HackAthon/yolov5/Dataset1/valid/labels... 120 images\u001b[0m\n",
      "\u001b[34m\u001b[1mval: \u001b[0mNew cache created: /home/abhinav/HackAthon/yolov5/Dataset1/valid/labels.cache\n",
      "\u001b[34m\u001b[1mval: \u001b[0mCaching images (0.1GB ram): 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 120/120 [00:00<00:00, 665.52it\u001b[0m\n",
      "\n",
      "\u001b[34m\u001b[1mAutoAnchor: \u001b[0m3.10 anchors/target, 0.985 Best Possible Recall (BPR). Current anchors are a good fit to dataset ‚úÖ\n",
      "Plotting labels to runs/train/exp51/labels.jpg... \n",
      "Image sizes 640 train, 640 val\n",
      "Using 6 dataloader workers\n",
      "Logging results to \u001b[1mruns/train/exp51\u001b[0m\n",
      "Starting training for 200 epochs...\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "      0/199      2.08G    0.08889    0.02664    0.05668         36        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155    0.00327      0.754     0.0227    0.00993\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "      1/199      3.57G     0.0577    0.02493    0.04705         30        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.493      0.148      0.133     0.0906\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "      2/199      3.57G    0.05469     0.0227    0.04246         34        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.607      0.172      0.142     0.0895\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "      3/199      3.57G    0.05404    0.02228      0.039         26        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.538      0.189      0.129     0.0719\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "      4/199      3.57G    0.04999    0.02212    0.03389         43        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.623       0.19      0.157     0.0983\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "      5/199      3.57G    0.04757    0.02151    0.03475         34        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.663      0.163      0.135     0.0997\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "      6/199      3.57G      0.048    0.02168    0.03451         36        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.537      0.288      0.204      0.138\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "      7/199      3.57G    0.04686    0.02159    0.03302         41        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.775      0.154      0.206      0.138\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "      8/199      3.57G    0.04504    0.02121    0.03219         41        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.596       0.21      0.168      0.116\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "      9/199      3.57G     0.0452    0.02143    0.03151         48        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.373      0.267      0.234      0.171\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     10/199      3.57G    0.04385    0.02085    0.03039         45        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.352      0.246      0.195      0.153\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     11/199      3.57G    0.04331     0.0201    0.02906         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.45      0.207      0.213      0.142\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     12/199      3.57G    0.04243    0.02013    0.02762         41        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.309       0.27      0.226       0.17\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     13/199      3.57G     0.0429    0.02043    0.02813         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.308      0.301      0.202      0.161\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     14/199      3.57G    0.04129    0.01991    0.02609         33        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.508      0.268      0.259      0.192\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     15/199      3.57G    0.04198    0.01939     0.0259         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.363      0.288       0.26      0.178\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     16/199      3.57G    0.04189    0.01926    0.02367         32        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.424      0.338      0.276       0.21\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     17/199      3.57G    0.04078     0.0195    0.02343         38        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.346      0.346      0.258      0.185\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     18/199      3.57G    0.03989    0.01883     0.0219         32        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.477      0.257      0.264      0.191\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     19/199      3.57G    0.03981    0.01874    0.02328         40        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.375      0.242      0.253        0.2\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     20/199      3.57G     0.0392    0.01941    0.02231         32        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.625      0.293      0.283      0.215\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     21/199      3.57G    0.03828    0.01866    0.01973         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.449      0.297      0.279      0.221\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     22/199      3.57G    0.03918     0.0194    0.02115         32        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.83      0.179      0.241       0.17\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     23/199      3.57G    0.03831    0.01861    0.02168         36        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.472      0.255      0.233      0.171\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     24/199      3.57G     0.0375    0.01831    0.02085         27        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.408      0.303      0.278      0.216\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     25/199      3.57G    0.03806    0.01791    0.01977         47        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.456      0.311      0.281      0.202\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     26/199      3.57G      0.037     0.0191    0.01948         41        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.406      0.331      0.265       0.22\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     27/199      3.57G    0.03695    0.01838    0.01843         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.355      0.349      0.278      0.206\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     28/199      3.57G    0.03766    0.01828    0.01965         40        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.602      0.231      0.261      0.195\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     29/199      3.57G    0.03848    0.01786     0.0176         34        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.474      0.311      0.279      0.221\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     30/199      3.57G    0.03646    0.01738    0.01665         33        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.448      0.343      0.281      0.217\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     31/199      3.57G    0.03625    0.01765    0.01686         40        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.417       0.33      0.307      0.239\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     32/199      3.57G    0.03685    0.01683    0.01751         42        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.543      0.245      0.289      0.232\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     33/199      3.57G    0.03725    0.01734    0.01757         35        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.831      0.214      0.286      0.216\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     34/199      3.57G    0.03511     0.0173    0.01473         36        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.479      0.285      0.281       0.22\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     35/199      3.57G    0.03473    0.01722    0.01413         44        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.436        0.3      0.313      0.247\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     36/199      3.57G    0.03556    0.01674    0.01632         30        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.598      0.255      0.306      0.249\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     37/199      3.57G    0.03452    0.01697    0.01618         42        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.412      0.352      0.308      0.241\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     38/199      3.57G    0.03512    0.01696    0.01604         42        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.546       0.29      0.283       0.22\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     39/199      3.57G    0.03469     0.0173    0.01407         30        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.396      0.332      0.285      0.229\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     40/199      3.57G    0.03577    0.01645    0.01356         37        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.47      0.346      0.346      0.281\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     41/199      3.57G    0.03513    0.01665    0.01392         40        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.47      0.329      0.302      0.239\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     42/199      3.57G    0.03335    0.01688    0.01356         51        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.597      0.253      0.276      0.225\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     43/199      3.57G    0.03417    0.01709    0.01399         41        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.443      0.316      0.302      0.252\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     44/199      3.57G    0.03397    0.01652    0.01345         27        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.455      0.286      0.284      0.234\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     45/199      3.57G     0.0339    0.01619    0.01364         35        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.46      0.329      0.305       0.24\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     46/199      3.57G    0.03338    0.01675    0.01351         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.442      0.294      0.289      0.212\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     47/199      3.57G    0.03327    0.01644    0.01215         33        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.443      0.298      0.295      0.241\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     48/199      3.57G    0.03213    0.01565    0.01295         34        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.462      0.327      0.305      0.229\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     49/199      3.57G    0.03415    0.01595    0.01309         38        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.519      0.293      0.323      0.247\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     50/199      3.57G    0.03342    0.01594     0.0129         36        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.495      0.313      0.299      0.244\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     51/199      3.57G    0.03248     0.0161    0.01241         28        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.541      0.277      0.328      0.259\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     52/199      3.57G    0.03261    0.01651    0.01342         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.663      0.302      0.331       0.27\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     53/199      3.57G    0.03269    0.01612    0.01178         46        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.775      0.294      0.326       0.26\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     54/199      3.57G    0.03327    0.01591    0.01064         41        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.462      0.318      0.317      0.259\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     55/199      3.57G     0.0339    0.01567    0.01158         38        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.438      0.316       0.29       0.24\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     56/199      3.57G    0.03286    0.01539    0.01142         29        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.511      0.281      0.304      0.247\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     57/199      3.57G    0.03134    0.01533    0.01171         37        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.42      0.324      0.302      0.241\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     58/199      3.57G    0.03126    0.01512    0.01208         41        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.472      0.305      0.301      0.249\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     59/199      3.57G    0.03079    0.01498    0.01072         34        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.496      0.285      0.291      0.237\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     60/199      3.57G    0.03207     0.0155    0.01054         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.472        0.3      0.303      0.252\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     61/199      3.57G    0.03126    0.01503    0.01007         38        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.574      0.252      0.274      0.227\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     62/199      3.57G    0.03084     0.0157    0.01063         47        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.478      0.312      0.304      0.253\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     63/199      3.57G    0.03075    0.01539    0.01134         43        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.451      0.337      0.278      0.217\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     64/199      3.57G    0.03002    0.01542   0.009941         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.525      0.268      0.291      0.229\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     65/199      3.57G    0.03126    0.01514    0.01013         45        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.416      0.319      0.301      0.247\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     66/199      3.57G    0.03044    0.01443     0.0108         35        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.515      0.269       0.31      0.255\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     67/199      3.57G    0.03026     0.0147   0.008256         36        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.473      0.307      0.312      0.237\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     68/199      3.57G    0.03184    0.01475   0.009282         38        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.555       0.29      0.307       0.25\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     69/199      3.57G    0.02972    0.01466   0.009837         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.567      0.257      0.299      0.252\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     70/199      3.57G    0.03096    0.01393    0.01014         36        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.481      0.289      0.321      0.239\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     71/199      3.57G     0.0307    0.01473   0.009904         45        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.453      0.348      0.301      0.245\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     72/199      3.57G    0.02917    0.01467   0.009237         28        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.403       0.29      0.287      0.237\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     73/199      3.57G    0.02846    0.01398     0.0095         36        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.473      0.321      0.321      0.272\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     74/199      3.57G    0.03004    0.01396     0.0101         37        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.553      0.277      0.302       0.25\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     75/199      3.57G    0.02967    0.01378    0.01001         52        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.517      0.358      0.324      0.264\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     76/199      3.57G    0.02891     0.0141    0.01012         37        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.482      0.278      0.286      0.238\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     77/199      3.57G    0.02925    0.01449    0.01029         35        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.416      0.306      0.294      0.253\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     78/199      3.57G     0.0286    0.01454   0.008789         54        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.49      0.309       0.32      0.268\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     79/199      3.57G    0.03015    0.01409   0.008665         52        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.686      0.279      0.328      0.269\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     80/199      3.57G    0.02982    0.01392   0.009471         27        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.405      0.344      0.286      0.234\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     81/199      3.57G    0.02961    0.01375    0.00863         46        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.422      0.293      0.289      0.235\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     82/199      3.57G    0.02698    0.01336   0.008206         42        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.455      0.343      0.318      0.266\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     83/199      3.57G    0.02814    0.01366   0.009488         33        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.556      0.313      0.328       0.25\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     84/199      3.57G     0.0286    0.01369   0.009003         44        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.459      0.325      0.297       0.25\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     85/199      3.57G    0.02809    0.01342   0.008138         33        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.592       0.28      0.335      0.268\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     86/199      3.57G    0.02727    0.01343   0.009791         47        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.68      0.314      0.351      0.284\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     87/199      3.57G    0.02817    0.01283   0.008417         37        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.477      0.316      0.308      0.253\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     88/199      3.57G    0.02698    0.01294   0.007366         33        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.488      0.332      0.324      0.265\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     89/199      3.57G     0.0286    0.01319   0.008045         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.473      0.327      0.309      0.249\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     90/199      3.57G    0.02877    0.01388   0.008984         42        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.474      0.352      0.314       0.25\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     91/199      3.57G    0.02744    0.01284   0.008042         36        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.484      0.342       0.32      0.267\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     92/199      3.57G    0.02777    0.01377   0.007695         35        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.585      0.309      0.338      0.275\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     93/199      3.57G    0.02692    0.01323   0.006862         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.53      0.307      0.315      0.273\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     94/199      3.57G    0.02645    0.01281   0.007765         46        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.526      0.313      0.336      0.272\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     95/199      3.57G    0.02663    0.01319   0.007634         34        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.533      0.334       0.35      0.275\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     96/199      3.57G    0.02617    0.01256   0.007025         41        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.467      0.321      0.331      0.263\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     97/199      3.57G    0.02787    0.01269   0.007807         37        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.479      0.318      0.323      0.264\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     98/199      3.57G    0.02666    0.01282   0.006638         40        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.524      0.303      0.337      0.279\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "     99/199      3.57G    0.02706    0.01225   0.005916         36        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.481      0.291      0.328      0.273\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    100/199      3.57G    0.02649    0.01254    0.00737         33        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.507      0.355      0.342       0.27\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    101/199      3.57G    0.02745    0.01268   0.006841         42        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.412      0.313      0.307      0.251\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    102/199      3.57G    0.02634    0.01235   0.007023         40        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.488       0.33      0.313       0.26\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    103/199      3.57G    0.02597    0.01302   0.007697         47        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.458      0.324      0.317      0.266\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    104/199      3.57G    0.02637    0.01253   0.006882         42        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.496      0.313      0.303      0.262\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    105/199      3.57G    0.02578    0.01211    0.00697         31        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.492      0.297      0.302      0.253\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    106/199      3.57G    0.02641    0.01274    0.00629         41        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.582      0.319      0.325      0.272\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    107/199      3.57G    0.02564    0.01247   0.006977         29        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.49      0.368      0.349      0.282\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    108/199      3.57G    0.02529    0.01242   0.006827         37        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.493      0.332      0.318      0.261\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    109/199      3.57G    0.02588    0.01253   0.006615         34        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.455      0.309      0.296      0.247\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    110/199      3.57G    0.02555    0.01233   0.006984         42        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.552      0.271      0.319      0.271\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    111/199      3.57G    0.02553    0.01219   0.006075         40        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.526      0.317       0.31      0.263\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    112/199      3.57G    0.02512    0.01249   0.005997         42        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.439      0.343      0.308      0.266\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    113/199      3.57G    0.02435    0.01218   0.006594         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.463      0.279      0.291      0.254\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    114/199      3.57G    0.02448    0.01165   0.005784         42        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.471      0.319      0.299      0.257\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    115/199      3.57G    0.02533    0.01202   0.006062         43        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.497      0.359      0.315      0.273\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    116/199      3.57G    0.02462     0.0121   0.005889         36        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.457      0.353      0.326       0.27\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    117/199      3.57G    0.02508    0.01203   0.006885         33        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.52      0.351      0.351      0.295\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    118/199      3.57G    0.02525    0.01201   0.006152         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.57      0.291      0.319      0.271\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    119/199      3.57G    0.02453    0.01203    0.00659         31        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.533      0.258      0.334      0.275\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    120/199      3.57G    0.02497     0.0121   0.005575         37        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.514      0.322      0.337      0.277\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    121/199      3.57G    0.02452    0.01178   0.005914         32        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.429      0.327      0.296      0.255\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    122/199      3.57G    0.02406    0.01212   0.005752         46        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.465       0.31      0.307      0.256\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    123/199      3.57G     0.0245    0.01167   0.005753         55        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.541      0.309      0.323      0.272\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    124/199      3.57G    0.02338     0.0113   0.006274         44        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.449      0.339      0.314      0.266\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    125/199      3.57G    0.02402    0.01134   0.006287         35        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.531      0.306      0.307      0.265\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    126/199      3.57G    0.02433    0.01157   0.006464         34        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.506      0.351      0.313      0.263\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    127/199      3.57G    0.02369    0.01146   0.005533         42        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.533       0.34      0.313      0.269\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    128/199      3.57G    0.02327    0.01161   0.005666         37        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.572      0.334      0.317      0.261\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    129/199      3.57G    0.02301    0.01191   0.005301         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.54      0.289      0.294      0.257\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    130/199      3.57G    0.02366    0.01172   0.004853         33        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.519      0.316      0.311      0.266\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    131/199      3.57G    0.02275    0.01108   0.005258         34        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.523      0.303      0.319       0.28\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    132/199      3.57G    0.02287    0.01117   0.006305         34        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.482       0.36      0.321      0.274\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    133/199      3.57G    0.02261    0.01072   0.005575         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.486      0.308      0.308      0.263\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    134/199      3.57G    0.02346    0.01086   0.005612         37        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.441       0.33        0.3      0.265\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    135/199      3.57G    0.02337    0.01137   0.005202         47        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.538      0.285      0.298      0.258\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    136/199      3.57G    0.02313    0.01139   0.004919         45        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.52      0.275      0.296      0.255\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    137/199      3.57G    0.02336    0.01144   0.005065         45        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.442      0.318      0.298      0.263\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    138/199      3.57G    0.02229      0.011   0.005891         38        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.46      0.322      0.292      0.255\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    139/199      3.57G    0.02158    0.01083   0.004843         36        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.534       0.34      0.316      0.274\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    140/199      3.57G    0.02237    0.01106   0.004878         35        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.504      0.336      0.335      0.284\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    141/199      3.57G    0.02292     0.0108   0.004621         42        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.605      0.332      0.344      0.286\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    142/199      3.57G    0.02165    0.01065     0.0044         37        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.531      0.312      0.305      0.261\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    143/199      3.57G    0.02119    0.01078   0.004327         45        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.503      0.294      0.307      0.262\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    144/199      3.57G    0.02223    0.01068   0.004891         36        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.47       0.36      0.316      0.265\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    145/199      3.57G    0.02052    0.01053   0.003971         36        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.56      0.305      0.324      0.276\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    146/199      3.57G    0.02248     0.0108   0.004665         37        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.528      0.282        0.3      0.257\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    147/199      3.57G    0.02106    0.01088   0.003825         50        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.543      0.329      0.332      0.273\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    148/199      3.57G    0.02144    0.01043   0.004871         34        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.514      0.352       0.33      0.274\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    149/199      3.57G    0.02214    0.01031   0.004301         35        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.55      0.329      0.331      0.275\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    150/199      3.57G     0.0215    0.01047   0.004486         33        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.499      0.347      0.328      0.277\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    151/199      3.57G     0.0212    0.01036   0.005682         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.505      0.324      0.319      0.274\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    152/199      3.57G    0.02161    0.01054    0.00406         41        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.518      0.313      0.315      0.269\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    153/199      3.57G    0.02105     0.0104   0.004786         43        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.473      0.317      0.317      0.274\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    154/199      3.57G    0.02187     0.0106   0.004049         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.487      0.323      0.302      0.257\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    155/199      3.57G    0.02122    0.01036   0.004181         28        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.488      0.306      0.298      0.259\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    156/199      3.57G    0.02088    0.01047   0.003606         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.528      0.302      0.325       0.28\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    157/199      3.57G    0.02043    0.01031   0.004691         25        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.551      0.274      0.311      0.268\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    158/199      3.57G    0.02092    0.01067   0.004414         40        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.547      0.308      0.311      0.271\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    159/199      3.57G    0.02064    0.01036   0.004168         35        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.535      0.323      0.325      0.276\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    160/199      3.57G    0.02108    0.01054   0.003842         52        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.528      0.327      0.329       0.28\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    161/199      3.57G    0.02087    0.01025   0.003768         42        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.562      0.295      0.311      0.267\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    162/199      3.57G    0.02112     0.0105   0.003513         37        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.599      0.257      0.318      0.275\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    163/199      3.57G    0.01968    0.01014   0.004569         41        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.471      0.308      0.317      0.273\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    164/199      3.57G     0.0203    0.01038   0.004001         41        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.551      0.322      0.331      0.284\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    165/199      3.57G    0.02115    0.01012   0.003956         37        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.512      0.333      0.327      0.279\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    166/199      3.57G    0.01996    0.01014   0.003583         42        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.514      0.346      0.341       0.29\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    167/199      3.57G    0.01958   0.009894    0.00448         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.485      0.363       0.33      0.284\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    168/199      3.57G    0.01974   0.009987   0.004191         45        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.539      0.346      0.327       0.28\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    169/199      3.57G    0.02004    0.01022   0.003718         41        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.541      0.302      0.332      0.286\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    170/199      3.57G    0.01939   0.009868   0.003521         34        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.517      0.361      0.336      0.284\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    171/199      3.57G    0.01952   0.009796   0.003822         45        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.455      0.344      0.324      0.276\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    172/199      3.57G    0.01928   0.009804   0.003879         40        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.533      0.302      0.331      0.285\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    173/199      3.57G    0.01903    0.01003   0.003559         24        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155       0.53      0.304      0.332      0.284\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    174/199      3.57G    0.01911   0.009193   0.004022         34        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.504      0.325       0.33      0.283\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    175/199      3.57G     0.0196   0.009829    0.00346         42        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.536      0.314      0.326      0.278\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    176/199      3.57G    0.01897    0.00944   0.003326         38        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.547      0.317       0.33      0.284\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    177/199      3.57G    0.01888   0.009548   0.003124         33        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.477      0.349      0.319      0.273\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    178/199      3.57G    0.01831   0.009879   0.003095         49        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.502      0.319       0.33       0.28\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    179/199      3.57G    0.01868   0.009515   0.003022         39        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.508      0.308      0.329      0.282\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    180/199      3.57G    0.01825     0.0092   0.003483         31        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.491      0.338      0.329      0.282\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    181/199      3.57G     0.0188   0.009372   0.003315         43        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.569      0.313      0.348      0.296\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    182/199      3.57G    0.01839   0.009553   0.002895         41        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155        0.5      0.348      0.337      0.286\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    183/199      3.57G    0.01833   0.009737   0.003113         41        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.503      0.345       0.33      0.282\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    184/199      3.57G    0.01759   0.009517   0.002854         41        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.495      0.364      0.331      0.282\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    185/199      3.57G     0.0183   0.009255   0.003434         36        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.529      0.335      0.344       0.29\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    186/199      3.57G    0.01798   0.009279   0.002824         34        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.586       0.33      0.343      0.286\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    187/199      3.57G    0.01838   0.009452   0.003587         35        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.598      0.332      0.359      0.292\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    188/199      3.57G    0.01876   0.009359    0.00417         43        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.515      0.358      0.351      0.293\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    189/199      3.57G    0.01827    0.00928    0.00326         50        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.479      0.371       0.34       0.29\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    190/199      3.57G    0.01767   0.009239   0.002711         38        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.556       0.32      0.341      0.288\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    191/199      3.57G    0.01867   0.009315   0.002639         37        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.531      0.337      0.339      0.291\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    192/199      3.57G    0.01731   0.009063   0.002418         34        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.489      0.362      0.338       0.29\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    193/199      3.57G    0.01684   0.009093   0.002859         38        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.493      0.363      0.332      0.284\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    194/199      3.57G    0.01723   0.009121   0.003044         40        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.511       0.37      0.343      0.292\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    195/199      3.57G    0.01735   0.008676    0.00244         38        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.497      0.356      0.341      0.291\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    196/199      3.57G    0.01691   0.008878   0.002815         29        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.488      0.379      0.338      0.287\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    197/199      3.57G     0.0171   0.009248   0.003406         51        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155        0.5      0.376      0.333      0.284\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    198/199      3.57G    0.01798   0.009204   0.003391         48        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.504      0.366      0.332      0.282\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   obj_loss   cls_loss  Instances       Size\n",
      "    199/199      3.57G    0.01716   0.008846   0.002592         45        640: 1\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.497      0.377      0.336      0.285\n",
      "\n",
      "200 epochs completed in 1.134 hours.\n",
      "Optimizer stripped from runs/train/exp51/weights/last.pt, 14.4MB\n",
      "Optimizer stripped from runs/train/exp51/weights/best.pt, 14.4MB\n",
      "\n",
      "Validating runs/train/exp51/weights/best.pt...\n",
      "Fusing layers... \n",
      "Model summary: 157 layers, 7031701 parameters, 0 gradients, 15.8 GFLOPs\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all        120        155      0.564      0.314      0.349      0.295\n",
      "                  Cans        120         23      0.433       0.13      0.185      0.158\n",
      "             Cardboard        120          8       0.23      0.125       0.14      0.106\n",
      "      Cigarettes-butts        120          3          1          0          0          0\n",
      "                 Glass        120         56      0.919      0.403      0.523       0.35\n",
      "                 Paper        120         18          0          0     0.0462     0.0305\n",
      "               Plastic        120         19      0.156      0.105     0.0825     0.0423\n",
      "      waste_bin_closed        120         20          1      0.996      0.995      0.972\n",
      "        waste_bin_open        120          8      0.777       0.75      0.818        0.7\n",
      "Results saved to \u001b[1mruns/train/exp51\u001b[0m\n"
     ]
    }
   ],
   "source": [
    "!python train.py --img 640 --batch 16 --epochs 200 --data custom.yaml --weights yolov5s.pt --cache"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "71fc6954",
   "metadata": {},
   "source": [
    "## Testing the trained module on test data set"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "12ff743d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[34m\u001b[1mdetect: \u001b[0mweights=['/home/abhinav/HackAthon/yolov5/runs/train/exp51/weights/best.pt'], source=/home/abhinav/HackAthon/yolov5/Dataset/test/images/, data=data/coco128.yaml, imgsz=[640, 640], conf_thres=0.25, iou_thres=0.45, max_det=1000, device=, view_img=False, save_txt=True, save_conf=False, save_crop=False, nosave=False, classes=None, agnostic_nms=False, augment=False, visualize=False, update=False, project=/home/abhinav/HackAthon/output, name=output1, exist_ok=False, line_thickness=3, hide_labels=False, hide_conf=False, half=False, dnn=False, vid_stride=1\n",
      "YOLOv5 üöÄ v7.0-180-g9bb50b4f Python-3.9.16 torch-2.0.1+cu117 CUDA:0 (NVIDIA GeForce GTX 1080 Ti, 11177MiB)\n",
      "\n",
      "Fusing layers... \n",
      "Model summary: 157 layers, 7031701 parameters, 0 gradients, 15.8 GFLOPs\n",
      "image 1/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/IMG_2306_jpg.rf.bfc13a67175084d911bfd7e15e377fd9.jpg: 640x640 1 Plastic, 13.0ms\n",
      "image 2/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/IMG_2316_jpg.rf.1c4bd1982b3a2936ba7ba56253721708.jpg: 640x640 1 Plastic, 13.0ms\n",
      "image 3/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/KakaoTalk_20240823_095343227_10_jpg.rf.a6ab493f2211936c751081bc83db5807.jpg: 640x640 (no detections), 12.8ms\n",
      "image 4/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/KakaoTalk_20240823_095423544_09_jpg.rf.305c1d77bae30ae887690f71819c9727.jpg: 640x640 1 Cardboard, 12.5ms\n",
      "image 5/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/KakaoTalk_20240823_095423544_22_jpg.rf.0b0934dd92d61407dcdd0fa9dcaea9f7.jpg: 640x640 1 Glass, 13.0ms\n",
      "image 6/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/KakaoTalk_20240823_095919243_15_jpg.rf.27d1948f11750c9f0d8e60a2c45acf2a.jpg: 640x640 1 Glass, 12.8ms\n",
      "image 7/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/frame_1024_jpg.rf.89c94dbcc199db26b2aab10bc030cbee.jpg: 640x640 1 waste_bin_open, 6.6ms\n",
      "image 8/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/frame_1152_jpg.rf.5909eee8312834fbfda68811cdf88920.jpg: 640x640 1 waste_bin_open, 12.7ms\n",
      "image 9/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/frame_1344_jpg.rf.8ab6f4ca2109d8dedcc57829563d4596.jpg: 640x640 1 waste_bin_closed, 13.1ms\n",
      "image 10/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/frame_144_jpg.rf.022bdd05935ce513c9a79257601851a4.jpg: 640x640 1 waste_bin_closed, 12.8ms\n",
      "image 11/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/frame_288_jpg.rf.12b90913a0819ef274bd07896c47ec9a.jpg: 640x640 1 waste_bin_closed, 13.1ms\n",
      "image 12/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/frame_576_jpg.rf.8a9fd8427719bf1c4f6cac4509c19bfb.jpg: 640x640 1 waste_bin_open, 8.7ms\n",
      "image 13/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/frame_720_jpg.rf.4a274fd072c024c37cfc9e0a3267078d.jpg: 640x640 1 waste_bin_open, 13.0ms\n",
      "image 14/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/frame_752_jpg.rf.d60017b31713f30c888af1cbf736d4f4.jpg: 640x640 (no detections), 12.9ms\n",
      "image 15/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/plastic_bottle-119_jpg.rf.959cde9c3fa0294d88436946a96ff861.jpg: 640x640 1 Plastic, 12.8ms\n",
      "Speed: 1.6ms pre-process, 12.2ms inference, 9.5ms NMS per image at shape (1, 3, 640, 640)\n",
      "Results saved to \u001b[1m/home/abhinav/HackAthon/output/output1\u001b[0m\n",
      "13 labels saved to /home/abhinav/HackAthon/output/output1/labels\n"
     ]
    }
   ],
   "source": [
    "!python detect.py --weights /home/abhinav/HackAthon/yolov5/runs/train/exp51/weights/best.pt --img 640 --conf 0.25 --source /home/abhinav/HackAthon/yolov5/Dataset/test/images/  --project /home/abhinav/HackAthon/output --name output1 --save-txt"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c0bccc5f",
   "metadata": {},
   "source": [
    "## Checking results on Validation dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "f2adbd4b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/home/abhinav/miniconda3/envs/yolotestcopy/lib/python3.9/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.26.4\n",
      "  warnings.warn(f\"A NumPy version >={np_minversion} and <{np_maxversion}\"\n",
      "\u001b[34m\u001b[1mval: \u001b[0mdata=/home/abhinav/HackAthon/yolov5/data/custom.yaml, weights=['runs/train/exp51/weights/best.pt'], batch_size=32, imgsz=640, conf_thres=0.25, iou_thres=0.6, max_det=300, task=test, device=, workers=8, single_cls=False, augment=False, verbose=False, save_txt=True, save_hybrid=False, save_conf=False, save_json=False, project=runs/val, name=exp, exist_ok=False, half=False, dnn=False\n",
      "WARNING ‚ö†Ô∏è confidence threshold 0.25 > 0.001 produces invalid results\n",
      "YOLOv5 üöÄ v7.0-180-g9bb50b4f Python-3.9.16 torch-2.0.1+cu117 CUDA:0 (NVIDIA GeForce GTX 1080 Ti, 11177MiB)\n",
      "\n",
      "Fusing layers... \n",
      "Model summary: 157 layers, 7031701 parameters, 0 gradients, 15.8 GFLOPs\n",
      "\u001b[34m\u001b[1mtest: \u001b[0mScanning /home/abhinav/HackAthon/yolov5/Dataset1/test/labels... 80 images,\u001b[0m\n",
      "\u001b[34m\u001b[1mtest: \u001b[0mNew cache created: /home/abhinav/HackAthon/yolov5/Dataset1/test/labels.cache\n",
      "                 Class     Images  Instances          P          R      mAP50   \n",
      "                   all         80         82      0.608      0.348      0.407      0.347\n",
      "             Cardboard         80          5          0          0          0          0\n",
      "      Cigarettes-butts         80          7          0          0          0          0\n",
      "                 Glass         80         24          1      0.331       0.63      0.463\n",
      "                 Paper         80          9          1          0          0          0\n",
      "               Plastic         80          9      0.525      0.444      0.547      0.396\n",
      "      waste_bin_closed         80         12        0.9       0.75      0.862      0.862\n",
      "        waste_bin_open         80         16      0.829      0.911      0.813      0.706\n",
      "Speed: 0.6ms pre-process, 8.7ms inference, 0.6ms NMS per image at shape (32, 3, 640, 640)\n",
      "Results saved to \u001b[1mruns/val/exp15\u001b[0m\n",
      "49 labels saved to runs/val/exp15/labels\n"
     ]
    }
   ],
   "source": [
    "!python val.py --weights runs/train/exp51/weights/best.pt --img 640 --conf-thres 0.25 --data custom.yaml --task test --save-txt"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "aabc68e6",
   "metadata": {},
   "source": [
    "## Converting to tflite model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "321c45aa",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/home/abhinav/miniconda3/envs/yolotestcopy/lib/python3.9/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.26.4\n",
      "  warnings.warn(f\"A NumPy version >={np_minversion} and <{np_maxversion}\"\n",
      "\u001b[34m\u001b[1mexport: \u001b[0mdata=data/coco128.yaml, weights=['runs/train/exp51/weights/best.pt'], imgsz=[640], batch_size=1, device=cpu, half=False, inplace=False, keras=False, optimize=False, int8=False, dynamic=False, simplify=False, opset=17, verbose=False, workspace=4, nms=False, agnostic_nms=False, topk_per_class=100, topk_all=100, iou_thres=0.45, conf_thres=0.25, include=['tflite']\n",
      "YOLOv5 üöÄ v7.0-180-g9bb50b4f Python-3.9.16 torch-2.0.1+cu117 CPU\n",
      "\n",
      "Fusing layers... \n",
      "Model summary: 157 layers, 7031701 parameters, 0 gradients, 15.8 GFLOPs\n",
      "\n",
      "\u001b[34m\u001b[1mPyTorch:\u001b[0m starting from runs/train/exp51/weights/best.pt with output shape (1, 25200, 13) (13.8 MB)\n",
      "\n",
      "\u001b[34m\u001b[1mTensorFlow SavedModel:\u001b[0m starting export with tensorflow 2.13.0...\n",
      "\n",
      "                 from  n    params  module                                  arguments                     \n",
      "2024-09-14 22:28:27.323084: E tensorflow/compiler/xla/stream_executor/cuda/cuda_driver.cc:268] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected\n",
      "  0                -1  1      3520  models.common.Conv                      [3, 32, 6, 2, 2]              \n",
      "  1                -1  1     18560  models.common.Conv                      [32, 64, 3, 2]                \n",
      "  2                -1  1     18816  models.common.C3                        [64, 64, 1]                   \n",
      "  3                -1  1     73984  models.common.Conv                      [64, 128, 3, 2]               \n",
      "  4                -1  1    115712  models.common.C3                        [128, 128, 2]                 \n",
      "  5                -1  1    295424  models.common.Conv                      [128, 256, 3, 2]              \n",
      "  6                -1  1    625152  models.common.C3                        [256, 256, 3]                 \n",
      "  7                -1  1   1180672  models.common.Conv                      [256, 512, 3, 2]              \n",
      "  8                -1  1   1182720  models.common.C3                        [512, 512, 1]                 \n",
      "  9                -1  1    656896  models.common.SPPF                      [512, 512, 5]                 \n",
      " 10                -1  1    131584  models.common.Conv                      [512, 256, 1, 1]              \n",
      " 11                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']          \n",
      " 12           [-1, 6]  1         0  models.common.Concat                    [1]                           \n",
      " 13                -1  1    361984  models.common.C3                        [512, 256, 1, False]          \n",
      " 14                -1  1     33024  models.common.Conv                      [256, 128, 1, 1]              \n",
      " 15                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']          \n",
      " 16           [-1, 4]  1         0  models.common.Concat                    [1]                           \n",
      " 17                -1  1     90880  models.common.C3                        [256, 128, 1, False]          \n",
      " 18                -1  1    147712  models.common.Conv                      [128, 128, 3, 2]              \n",
      " 19          [-1, 14]  1         0  models.common.Concat                    [1]                           \n",
      " 20                -1  1    296448  models.common.C3                        [256, 256, 1, False]          \n",
      " 21                -1  1    590336  models.common.Conv                      [256, 256, 3, 2]              \n",
      " 22          [-1, 10]  1         0  models.common.Concat                    [1]                           \n",
      " 23                -1  1   1182720  models.common.C3                        [512, 512, 1, False]          \n",
      " 24      [17, 20, 23]  1     35061  models.yolo.Detect                      [8, [[10, 13, 16, 30, 33, 23], [30, 61, 62, 45, 59, 119], [116, 90, 156, 198, 373, 326]], [128, 256, 512], [640, 640]]\n",
      "Model: \"model\"\n",
      "__________________________________________________________________________________________________\n",
      " Layer (type)                Output Shape                 Param #   Connected to                  \n",
      "==================================================================================================\n",
      " input_1 (InputLayer)        [(1, 640, 640, 3)]           0         []                            \n",
      "                                                                                                  \n",
      " tf_conv (TFConv)            (1, 320, 320, 32)            3488      ['input_1[0][0]']             \n",
      "                                                                                                  \n",
      " tf_conv_1 (TFConv)          (1, 160, 160, 64)            18496     ['tf_conv[0][0]']             \n",
      "                                                                                                  \n",
      " tfc3 (TFC3)                 (1, 160, 160, 64)            18624     ['tf_conv_1[0][0]']           \n",
      "                                                                                                  \n",
      " tf_conv_7 (TFConv)          (1, 80, 80, 128)             73856     ['tfc3[0][0]']                \n",
      "                                                                                                  \n",
      " tfc3_1 (TFC3)               (1, 80, 80, 128)             115200    ['tf_conv_7[0][0]']           \n",
      "                                                                                                  \n",
      " tf_conv_15 (TFConv)         (1, 40, 40, 256)             295168    ['tfc3_1[0][0]']              \n",
      "                                                                                                  \n",
      " tfc3_2 (TFC3)               (1, 40, 40, 256)             623872    ['tf_conv_15[0][0]']          \n",
      "                                                                                                  \n",
      " tf_conv_25 (TFConv)         (1, 20, 20, 512)             1180160   ['tfc3_2[0][0]']              \n",
      "                                                                                                  \n",
      " tfc3_3 (TFC3)               (1, 20, 20, 512)             1181184   ['tf_conv_25[0][0]']          \n",
      "                                                                                                  \n",
      " tfsppf (TFSPPF)             (1, 20, 20, 512)             656128    ['tfc3_3[0][0]']              \n",
      "                                                                                                  \n",
      " tf_conv_33 (TFConv)         (1, 20, 20, 256)             131328    ['tfsppf[0][0]']              \n",
      "                                                                                                  \n",
      " tf_upsample (TFUpsample)    (1, 40, 40, 256)             0         ['tf_conv_33[0][0]']          \n",
      "                                                                                                  \n",
      " tf_concat (TFConcat)        (1, 40, 40, 512)             0         ['tf_upsample[0][0]',         \n",
      "                                                                     'tfc3_2[0][0]']              \n",
      "                                                                                                  \n",
      " tfc3_4 (TFC3)               (1, 40, 40, 256)             361216    ['tf_concat[0][0]']           \n",
      "                                                                                                  \n",
      " tf_conv_39 (TFConv)         (1, 40, 40, 128)             32896     ['tfc3_4[0][0]']              \n",
      "                                                                                                  \n",
      " tf_upsample_1 (TFUpsample)  (1, 80, 80, 128)             0         ['tf_conv_39[0][0]']          \n",
      "                                                                                                  \n",
      " tf_concat_1 (TFConcat)      (1, 80, 80, 256)             0         ['tf_upsample_1[0][0]',       \n",
      "                                                                     'tfc3_1[0][0]']              \n",
      "                                                                                                  \n",
      " tfc3_5 (TFC3)               (1, 80, 80, 128)             90496     ['tf_concat_1[0][0]']         \n",
      "                                                                                                  \n",
      " tf_conv_45 (TFConv)         (1, 40, 40, 128)             147584    ['tfc3_5[0][0]']              \n",
      "                                                                                                  \n",
      " tf_concat_2 (TFConcat)      (1, 40, 40, 256)             0         ['tf_conv_45[0][0]',          \n",
      "                                                                     'tf_conv_39[0][0]']          \n",
      "                                                                                                  \n",
      " tfc3_6 (TFC3)               (1, 40, 40, 256)             295680    ['tf_concat_2[0][0]']         \n",
      "                                                                                                  \n",
      " tf_conv_51 (TFConv)         (1, 20, 20, 256)             590080    ['tfc3_6[0][0]']              \n",
      "                                                                                                  \n",
      " tf_concat_3 (TFConcat)      (1, 20, 20, 512)             0         ['tf_conv_51[0][0]',          \n",
      "                                                                     'tf_conv_33[0][0]']          \n",
      "                                                                                                  \n",
      " tfc3_7 (TFC3)               (1, 20, 20, 512)             1181184   ['tf_concat_3[0][0]']         \n",
      "                                                                                                  \n",
      " tf_detect (TFDetect)        ((1, 25200, 13),             35061     ['tfc3_5[0][0]',              \n",
      "                             )                                       'tfc3_6[0][0]',              \n",
      "                                                                     'tfc3_7[0][0]']              \n",
      "                                                                                                  \n",
      "==================================================================================================\n",
      "Total params: 7031701 (26.82 MB)\n",
      "Trainable params: 0 (0.00 Byte)\n",
      "Non-trainable params: 7031701 (26.82 MB)\n",
      "__________________________________________________________________________________________________\n",
      "\u001b[34m\u001b[1mTensorFlow SavedModel:\u001b[0m export success ‚úÖ 4.9s, saved as runs/train/exp51/weights/best_saved_model (27.1 MB)\n",
      "\n",
      "\u001b[34m\u001b[1mTensorFlow Lite:\u001b[0m starting export with tensorflow 2.13.0...\n",
      "\u001b[34m\u001b[1mTensorFlow Lite:\u001b[0m export success ‚úÖ 30.4s, saved as runs/train/exp51/weights/best-fp16.tflite (13.5 MB)\n",
      "\n",
      "Export complete (35.7s)\n",
      "Results saved to \u001b[1m/home/abhinav/HackAthon/yolov5/runs/train/exp51/weights\u001b[0m\n",
      "Detect:          python detect.py --weights runs/train/exp51/weights/best-fp16.tflite \n",
      "Validate:        python val.py --weights runs/train/exp51/weights/best-fp16.tflite \n",
      "PyTorch Hub:     model = torch.hub.load('ultralytics/yolov5', 'custom', 'runs/train/exp51/weights/best-fp16.tflite')  \n",
      "Visualize:       https://netron.app\n"
     ]
    }
   ],
   "source": [
    "!python export.py --weights runs/train/exp51/weights/best.pt --include tflite --img 640"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "5e9d1050",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/home/abhinav/miniconda3/envs/yolotestcopy/lib/python3.9/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.26.4\n",
      "  warnings.warn(f\"A NumPy version >={np_minversion} and <{np_maxversion}\"\n",
      "\u001b[34m\u001b[1mdetect: \u001b[0mweights=['/home/abhinav/HackAthon/yolov5/runs/train/exp51/weights/best-fp16.tflite'], source=/home/abhinav/HackAthon/yolov5/Dataset/test/images/, data=data/coco128.yaml, imgsz=[640, 640], conf_thres=0.25, iou_thres=0.45, max_det=1000, device=, view_img=False, save_txt=True, save_conf=False, save_crop=False, nosave=False, classes=None, agnostic_nms=False, augment=False, visualize=False, update=False, project=/home/abhinav/HackAthon/output, name=outputoftflite, exist_ok=False, line_thickness=3, hide_labels=False, hide_conf=False, half=False, dnn=False, vid_stride=1\n",
      "YOLOv5 üöÄ v7.0-180-g9bb50b4f Python-3.9.16 torch-2.0.1+cu117 CUDA:0 (NVIDIA GeForce GTX 1080 Ti, 11177MiB)\n",
      "\n",
      "Loading /home/abhinav/HackAthon/yolov5/runs/train/exp51/weights/best-fp16.tflite for TensorFlow Lite inference...\n",
      "INFO: Created TensorFlow Lite XNNPACK delegate for CPU.\n",
      "image 1/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/IMG_2306_jpg.rf.bfc13a67175084d911bfd7e15e377fd9.jpg: 640x640 1 bus, 209.5ms\n",
      "image 2/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/IMG_2316_jpg.rf.1c4bd1982b3a2936ba7ba56253721708.jpg: 640x640 1 bus, 179.5ms\n",
      "image 3/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/KakaoTalk_20240823_095343227_10_jpg.rf.a6ab493f2211936c751081bc83db5807.jpg: 640x640 (no detections), 175.5ms\n",
      "image 4/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/KakaoTalk_20240823_095423544_09_jpg.rf.305c1d77bae30ae887690f71819c9727.jpg: 640x640 1 bicycle, 175.2ms\n",
      "image 5/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/KakaoTalk_20240823_095423544_22_jpg.rf.0b0934dd92d61407dcdd0fa9dcaea9f7.jpg: 640x640 1 motorcycle, 175.6ms\n",
      "image 6/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/KakaoTalk_20240823_095919243_15_jpg.rf.27d1948f11750c9f0d8e60a2c45acf2a.jpg: 640x640 1 motorcycle, 175.5ms\n",
      "image 7/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/frame_1024_jpg.rf.89c94dbcc199db26b2aab10bc030cbee.jpg: 640x640 1 truck, 174.8ms\n",
      "image 8/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/frame_1152_jpg.rf.5909eee8312834fbfda68811cdf88920.jpg: 640x640 1 truck, 177.5ms\n",
      "image 9/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/frame_1344_jpg.rf.8ab6f4ca2109d8dedcc57829563d4596.jpg: 640x640 1 train, 176.1ms\n",
      "image 10/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/frame_144_jpg.rf.022bdd05935ce513c9a79257601851a4.jpg: 640x640 1 train, 176.0ms\n",
      "image 11/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/frame_288_jpg.rf.12b90913a0819ef274bd07896c47ec9a.jpg: 640x640 1 train, 175.5ms\n",
      "image 12/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/frame_576_jpg.rf.8a9fd8427719bf1c4f6cac4509c19bfb.jpg: 640x640 1 truck, 174.8ms\n",
      "image 13/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/frame_720_jpg.rf.4a274fd072c024c37cfc9e0a3267078d.jpg: 640x640 1 truck, 177.2ms\n",
      "image 14/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/frame_752_jpg.rf.d60017b31713f30c888af1cbf736d4f4.jpg: 640x640 (no detections), 175.0ms\n",
      "image 15/15 /home/abhinav/HackAthon/yolov5/Dataset/test/images/plastic_bottle-119_jpg.rf.959cde9c3fa0294d88436946a96ff861.jpg: 640x640 1 bus, 175.9ms\n",
      "Speed: 0.4ms pre-process, 178.2ms inference, 0.7ms NMS per image at shape (1, 3, 640, 640)\n",
      "Results saved to \u001b[1m/home/abhinav/HackAthon/output/outputoftflite\u001b[0m\n",
      "13 labels saved to /home/abhinav/HackAthon/output/outputoftflite/labels\n"
     ]
    }
   ],
   "source": [
    "!python detect.py --weights /home/abhinav/HackAthon/yolov5/runs/train/exp51/weights/best-fp16.tflite --img 640 --conf 0.25 --source /home/abhinav/HackAthon/yolov5/Dataset/test/images/  --project /home/abhinav/HackAthon/output --name outputoftflite --save-txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5eccf579",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ae7652e2",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.16"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
